SPECIFICATION Spec
CONSTANTS 
Nil = Nil
Server = {n1, n2, n3}
Secondary = Secondary
Primary = Primary
MaxLogLen = 3
MaxTerm = 4
MaxConfigVersion = 4
CONSTRAINT StateConstraint
INVARIANT StateMachineSafety
INVARIANT LeaderCompleteness
INVARIANT ElectionSafety

\* Work in Raft but not Mongo
\*INVARIANT LogMatching 

\* I would exepect to work in Raft (not sure) but not in Mongo
\*INVARIANT CurrentTermAtLeastAsLargeAsLogTerms
\*INVARIANT HighestTermPrimaryMustHaveNonRollbackQuorum 

(* Properties In the II *)
(*
INVARIANT ConfigsMustBeSame
INVARIANT TermsOfEntriesGrowMonotonically
INVARIANT OnePrimaryPerTerm
INVARIANT NonZeroLogsImplyExistsPrimary 
INVARIANT CurrentTermAtLeastAsLargeAsLogTermsForPrimary 
INVARIANT LargestPrimaryMustHaveAQuorumInTerm
INVARIANT LogsMustBeSmallerThanOrEqualToLargestTerm 

INVARIANT CommittedEntriesMustHaveQuorums 
INVARIANT CommittedTermMatchesEntry 
INVARIANT OneCommitPerIndex
INVARIANT CommittedEntryIndMustBeSmallerThanOrEqualtoAllLogLens 
INVARIANT CommittedEntryTermMustBeSmallerThanOrEqualtoAllTerms 

INVARIANT LogsLaterThanCommittedMustHaveCommitted 
INVARIANT LeaderLogContainsPastCommittedEntries 
INVARIANT SecondariesMustFollowPrimaries 
INVARIANT SecondariesMustFollowPrimariesLog
INVARIANT HighestPrimaryCanRollbackNonconformingEntries 
INVARIANT MissingACommitImpliesCanBeRolledBack 

INVARIANT LogsLaterThanCommittedMustHaveCommitted2 
*)

\* Goals
INVARIANT StateMachineSafety 
INVARIANT LeaderCompleteness 
INVARIANT ElectionSafety 

\* catch all
\*INVARIANT StateMachineSafetyIndNew


SYMMETRY ServerSymmetry
VIEW stateView
\* We don't expect this invariant to hold.
\* INVARIANT FutureCommittedImpliesImmediatelyCommitted
\* INVARIANT ImmediatelyCommittedImpliesFutureCommitted

\* ALIAS Alias
